{% extends 'minimal.html' %}

{% block title %}
<h1>Detalhes da Atração: {{ atracao.nome }}</h1>
{% endblock title %}

{% block main %}
<div class="card border-primary-subtle shadow rounded-3 mb-4">
    <div class="card-header text-primary-emphasis bg-primary-subtle border border-primary-subtle rounded-3 mb-3 text-center">
        <h3 class="mb-0">{{ atracao.nome }}</h3>
        <!-- CORRIGIDO: Substituindo atracao._meta.model_name (proibido) pela variável de contexto 'model_name' -->
        <p class="mb-0 text-muted">Detalhes de um objeto tipo: <span class="badge bg-secondary">{{ model_name|capfirst }}</span></p>
    </div>
    <div class="card-body text-start">

        <!-- DETALHES GERAIS -->
        <h5 class="card-title text-primary mb-3"><i class="bi bi-info-circle-fill"></i> Detalhes Gerais da Atração</h5>
        
        <dl class="row">
            <!-- Nota -->
            <dt class="col-sm-3">Avaliação (Nota):</dt>
            <dd class="col-sm-9">
                <span class="badge bg-warning text-dark me-2">{{ atracao.nota|floatformat:1 }} / 5.0</span>
            </dd>

            <!-- Ingresso -->
            <dt class="col-sm-3">Requer Ingresso:</dt>
            <dd class="col-sm-9">
                {% if atracao.ingresso %}
                    <span class="badge bg-success">Sim</span>
                {% else %}
                    <span class="badge bg-danger">Não</span>
                {% endif %}
            </dd>

            <!-- Valor (Preço) -->
            <dt class="col-sm-3">Valor Estimado:</dt>
            <dd class="col-sm-9">
                {% if atracao.valor %}
                    R$ {{ atracao.valor|floatformat:2 }}
                {% else %}
                    <span class="text-muted">(Não informado / Gratuito)</span>
                {% endif %}
            </dd>

            <!-- Telefone -->
            <dt class="col-sm-3">Telefone:</dt>
            <dd class="col-sm-9">
                {% if atracao.telefone %}
                    {{ atracao.telefone }}
                {% else %}
                    <span class="text-muted">(Não informado)</span>
                {% endif %}
            </dd>

            <!-- Site -->
            <dt class="col-sm-3">Site:</dt>
            <dd class="col-sm-9">
                {% if atracao.site %}
                    <a href="{{ atracao.site }}" target="_blank" rel="noopener noreferrer" class="link-primary">{{ atracao.site }} <i class="bi bi-box-arrow-up-right"></i></a>
                {% else %}
                    <span class="text-muted">(Não disponível)</span>
                {% endif %}
            </dd>
        </dl>

        <hr>

        <!-- INFORMACOES (Descrição em texto longo) -->
        <h5 class="card-title text-primary"><i class="bi bi-card-text"></i> Descrição/Informações Detalhadas</h5>
        <p class="card-text">{{ atracao.informacoes|default:"Nenhuma descrição detalhada fornecida." }}</p>
        <hr>
        
        <!-- CATEGORIA (Singular) -->
        <h5 class="card-title text-primary"><i class="bi bi-tags-fill"></i> Categoria</h5>
        <div class="d-flex flex-wrap gap-2 mb-4">
            {% if atracao.categoria %}
            <dl class="row w-100">
                <!-- Nome e Classificação da Categoria -->
                <dt class="col-sm-3">Nome:</dt>
                <dd class="col-sm-9">
                    <span class="badge rounded-pill bg-success-subtle text-success-emphasis py-2 px-3">
                        {{ atracao.categoria.nome }} ({{ atracao.categoria.get_classificacao_display }})
                    </span>
                </dd>
                
                <!-- Descrição da Categoria -->
                <dt class="col-sm-3">Descrição:</dt>
                <dd class="col-sm-9">
                    <p class="text-muted mb-0">{{ atracao.categoria.descricao }}</p>
                </dd>
            </dl>
            {% else %}
                <p class="text-muted">Nenhuma categoria associada.</p>
            {% endif %}
        </div>
        <hr>

        <!-- DETALHES ESPECÍFICOS (Endereço, apenas para Local) -->
        {% if atracao.endereco %}
            <div class="mb-4">
                <h5 class="card-title text-primary"><i class="bi bi-geo-alt-fill"></i> Endereço Físico</h5>
                <dl class="row">
                    <dt class="col-sm-3">Logradouro:</dt>
                    <dd class="col-sm-9">{{ atracao.endereco.logradouro }}, {{ atracao.endereco.numero }}</dd>
                    
                    <dt class="col-sm-3">Complemento:</dt>
                    <dd class="col-sm-9">
                        {% if atracao.endereco.complemento %}
                            {{ atracao.endereco.complemento }}
                        {% else %}
                            <span class="text-muted">(Não informado)</span>
                        {% endif %}
                    </dd>

                    <dt class="col-sm-3">Bairro / Cidade:</dt>
                    <dd class="col-sm-9">{{ atracao.endereco.bairro }} / {{ atracao.endereco.cidade }} ({{ atracao.endereco.estado }})</dd>
                    
                    <dt class="col-sm-3">País / CEP:</dt>
                    <dd class="col-sm-9">{{ atracao.endereco.pais }} (CEP: {{ atracao.endereco.cep }})</dd>
                </dl>
            </div>
            <hr>
        {% endif %}
        
        <!-- DETALHES ESPECÍFICOS (Exemplo para Atividade - Apenas para Subclasses) -->
        {% if atracao.duracao_horas %}
             <div class="mb-4">
                <h5 class="card-title text-primary"><i class="bi bi-clock-fill"></i> Detalhes da Atividade (Subclasse)</h5>
                <dl class="row">
                    <dt class="col-sm-3">Duração:</dt>
                    <dd class="col-sm-9">{{ atracao.duracao_horas }} horas</dd>
                    
                    <dt class="col-sm-3">Preço Médio:</dt>
                    <dd class="col-sm-9">R$ {{ atracao.preco_medio|floatformat:2 }}</dd>
                </dl>
            </div>
            <hr>
        {% endif %}

    </div>
    <div class="card-footer text-center">
        <!-- Manter o link para a lista de atrações (se o URL estiver definido) -->
        <a href="{% url 'tripAdvisor:listar_atracoes' %}" class="btn btn-outline-secondary">
            <i class="bi bi-arrow-left"></i> Voltar para a Lista
        </a>
    </div>
</div>
{% endblock main %}