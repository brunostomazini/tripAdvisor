{% extends 'base.html' %}

{% block title %}

<!-- Título Dinâmico: Altera entre "Criar" e "Editar" -->

<h1>{% if object %}Editar Viagem: {{ object.titulo }}{% else %}Criar Nova Viagem{% endif %}</h1>
{% endblock title %}

{% block content %}

<!--
Ação Dinâmica:

Se 'object' existir (UpdateView), usa a URL de edição com o PK da viagem.

Se 'object' não existir (CreateView), usa a URL de adição.
-->

<form id="viagemForm" action="{% if object %}{% url 'tripAdvisor:update_viagem' pk=object.pk %}{% else %}{% url 'tripAdvisor:create_viagem' %}{% endif %}" method="post" class="p-4 rounded shadow-sm">
{% csrf_token %}

<!--
Os campos agora vêm com as classes Bootstrap (form-control e is-invalid)
graças à definição de 'widgets' no seu ViagemForm.
-->

<div class="row g-3">
{% for field in form %}
<div class="col-12
{% if field.field.widget.input_type == 'date' or field.field.widget.input_type == 'number' %}col-md-6{% endif %}
{% if field.name == 'descricao' or field.name == 'notas' or field.name == 'atracoes' %}col-12{% endif %}
">
<label for="{{ field.id_for_label }}" class="form-label">{{ field.label }}</label>

<!-- O widget do campo já está correto. -->
{{ field }}

<!-- Exibição de Erros -->
{% if field.errors %}
    <div class="text-danger small mt-1">
        {% for error in field.errors %}
            {{ error }}
        {% endfor %}
    </div>
{% endif %}

<!-- Texto de Ajuda Opcional -->
{% if field.help_text %}
    <div class="form-text">{{ field.help_text }}</div>
{% endif %}


</div>

{% endfor %}

<!-- Erros de Formulário Não-Campo (Non-field errors) -->

{% if form.non_field_errors %}

<div class="alert alert-danger mt-3" role="alert">
{% for error in form.non_field_errors %}
<p class="mb-0">{{ error }}</p>
{% endfor %}
</div>
{% endif %}

</div>

<!-- Botões de Ação DENTRO do Formulário -->

<div class="d-flex justify-content-start gap-3 mt-4">
<button type="submit" class="btn btn-success btn-lg">
<i class="bi bi-floppy"></i> Salvar
</button>

<button type="reset" class="btn btn-warning btn-lg">
<i class="bi bi-arrow-clockwise"></i> Limpar
</button>

<!-- Botão Voltar -->

<a class="btn btn-outline-secondary btn-lg" role="button" href="{% url 'profile' %}">
<i class="bi bi-arrow-left"></i> Voltar
</a>

</div>

</form>

{% endblock content %}